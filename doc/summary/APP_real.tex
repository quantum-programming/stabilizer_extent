\providecommand{\main}{.}
\documentclass[\main/main]{subfiles}
\setboolean{isMain}{false}

\begin{document}

\ifthenelse{\boolean{isMain}}{}{
    \begin{restatable}{theorem}{restrictedRealProblem}
        \label{thm:restrictedRealProblem}
        Suppose that the state $\ket{\psi}$ is real.
        If we substitute the column set $\calA_n$ with $\calA'_n$
        in the problem~\eqref{eq:stabilizerExtentPrimal},
        the optimal solution of the restricted problem
        is also optimal for the original problem.
    \end{restatable}
}

\section{The proof of Theorem~\ref{thm:restrictedRealProblem}}

In this section, we prove Theorem~\ref{thm:restrictedRealProblem}.
The proof is based on the following lemma.
\begin{lemma}{\label{lem:absRealForTIsAbsRealForS}}
    Suppose $y$ is a real vector and satisfies
    $\abs{a^\dagger y} \leq 1$ for all $a \in \calA'_n$
    such that $a$ is a real vector.
    Then, $y$ satisfies
    $\abs{a^\dagger y} \leq 1$ for all $a \in \calA_n$.
\end{lemma}
\begin{proof}
    Fix $a \in \calA$ and suppose that $a$ represents
    the state $\ket{\phi}$.
    Now, consider to write $\ket{\phi}$ as in the form~\eqref{eq:stabilizerStateStandardForm}.
    The case $k=0$ is trivial since then $a \in \calA'_n$.
    Suppose that $\ket{\phi_i}$ can be written as
    $\frac{1}{2^{k/2}}\sum_{x=0}^{2^k-1} (-1)^{x^\top Q x} i^{c^\top x} \ket{Rx+t}$ with $k>0$
    and
    $a^\dagger y = \alpha + i\beta \quad (\alpha, \beta \in \bbR)$.
    The following two states
    \begin{equation*}
        \ket{\phi_+} \defeq \frac{1}{2^{k/2}}\sum_{x=0}^{2^k-1} (-1)^{x^\top Q x} \ket{Rx+t}, \quad
        \ket{\phi_-} \defeq \frac{1}{2^{k/2}}\sum_{x=0}^{2^k-1} (-1)^{x^\top Q x + c^\top x} \ket{Rx+t}
    \end{equation*}
    belongs to $\calA'_n$,
    and denote the column vectors of $\ket{\phi_+}$ and $\ket{\phi_-}$ as $a_+$ and $a_-$, respectively.
    Then, we have $a_+^\dagger y = \alpha+\beta, a_-^\dagger y = \alpha-\beta$
    from the assumption, and
    \begin{equation*}
        \abs{a^\dagger y}
        =\sqrt{\alpha^2 + \beta^2}
        \leq \abs{\alpha}+\abs{\beta}
        = \max\{\abs{\alpha+\beta}, \abs{\alpha-\beta}\}
        \leq 1,
    \end{equation*}
    which completes the proof.
\end{proof}

Now, we are ready to prove Theorem~\ref{thm:restrictedRealProblem}.

\restrictedRealProblem*
\begin{proof}
    Let $x^*$ and $y^*$ be the optimal solutions
    of the restricted primal and dual problems,
    namely, the problem~\eqref{eq:stabilizerExtentPrimal}
    and the problem~\eqref{eq:stabilizerExtentDual}
    with the column set $\calA'_n$ instead of $\calA_n$.
    We can assure such solutions always exists.
    Now, we show that the $x^*, y^*$ are
    optimal not only for the restricted problems
    but also for the original problems.

    Let $\mathrm{OPT}$ be the optimal value for the original problem.
    Since $x^*$ can be a feasible solution for the original primal problem,
    it is clear that $\mathrm{OPT} \leq \norm{x^*}_1$.
    By the strong duality theorem,
    $\mathrm{OPT}$ is also the optimal value
    for the original dual problem.
    From the lemma \ref{lem:absRealForTIsAbsRealForS},
    we can see that $y^*$ is a feasible solution
    for the original dual problem and $\mathrm{OPT} \geq \Re{b^\dagger y^*}$.
    Again, by applying the strong duality theorem
    to the restricted problems,
    we have $\norm{x^*}_1 = \Re{b^\dagger y^*}$,
    which means that $\mathrm{OPT} = \norm{x^*}_1 = \Re{b^\dagger y^*}$.
    Therefore, $x^*$ and $y^*$ are also optimal solutions
    for the original problems.
\end{proof}

\end{document}